The SceneMiddleware is the indirection layer between the Scene and the internal Systems. <br/>
When a component is added to a node, the component internal resource is allocated from one of the scene middlewares.

Scene middlewares also act as interface for scene component deallocation event.

The scene middlewares can consume the state of the node to tell whether a specific node has changed this frame, to notify internal systems.

# Architecture

<svg-inline src="scene_middleware_architecture.svg"></svg-inline>

* SceneMiddleware: holds functions for component deallocation
* XXX Component Unit: responsible for deferred allocation of component
* XXX Middleware: the system that communicate node events to internal systems

# Component objects allocation

Component objects are allocated by the user by using the same deferred allocation mechanism as the resources. However, every component objects has its ID that is generated by the unit. <br/>

> **WARNING**: Because component objects may depend of some resources, resources allocation must be exectued before.

The same logic goes for deallocation.

# Scene node event push

Middlewares hold an array of structure that links the node to the component object.
When necessary, the middleware can iterate over this array to check the state of the node. <br/>
If criteria are met (for example: the node has moved during the last frame), then a notification can be sent to the internal system.